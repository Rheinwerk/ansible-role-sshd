# This file was generated by Ansible. Do not change manually.
# See the sshd_config(5) manpage for details

Port {{ (_sshd.network|default({})).port|default(22) }}
{% for addr in (_sshd.network|default({})).bind_addresses|default(['0.0.0.0','::']) %}
ListenAddress {{ addr }}
{% endfor %}
TCPKeepAlive yes
Protocol 2

{% if _sshd.host_keys is defined %}
{% for hk in _sshd.host_keys %}
HostKey /etc/ssh/{{ hk.filename }}
{% endfor %}
{% else %}
HostKey /etc/ssh/ssh_host_dsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key
HostKey /etc/ssh/ssh_host_rsa_key
{% endif %}
{% if _sshd.host_certificate is defined %}
HostCertificate /etc/ssh/{{ _sshd.host_certificate.filename }}
{% endif %}

HostbasedAuthentication no
IgnoreRhosts yes
KeyRegenerationInterval 3600
ServerKeyBits 1024
StrictModes yes

Subsystem sftp /usr/lib/openssh/sftp-server

X11Forwarding no

LogLevel INFO
SyslogFacility AUTH
UsePrivilegeSeparation yes
UsePAM yes

AcceptEnv LANG LC_*
LoginGraceTime 120
PrintLastLog yes
PrintMotd no

ChallengeResponseAuthentication no
PasswordAuthentication {% if (_sshd.auth_methods|default({})).allow_password|default(false) %}yes{% else %}no{% endif %}

PermitEmptyPasswords no
PermitRootLogin without-password
PubkeyAuthentication {% if (_sshd.auth_methods|default({})).allow_password|default(true) %}yes{% else %}no{% endif %}

RSAAuthentication yes
RhostsRSAAuthentication no

{% if _sshd.authorized_keys_files is defined %}
AuthorizedKeysFile {{ _sshd.authorized_keys_files|join(" ") }}
{% endif %}

{% if _sshd.trusted_user_ca %}
TrustedUserCAKeys /etc/ssh/{{ _sshd.trusted_user_ca.filename }}
{% endif %}

{% if _sshd.authorized_principals is defined %}
AuthorizedPrincipalsFile /etc/ssh/{{ _sshd_.authorized_principals.filename_pattern }}
{% endif %}

{% if _sshd.deny_users is defined %}
DenyUsers {{ _sshd.deny_users|join(" ") }}
{% endif %}

{% if _sshd.allow_users is defined %}
AllowUsers {{ _sshd.allow_users|join(" ") }}
{% elif _sshd.allow_groups is defined %}
AllowGroups {{ _sshd.allow_groups|join(" ") }}
{% endif %}

{% if _sshd.deny_groups is defined %}
DenyGroups {{ _sshd.deny_groups|join(" ") }}
{% endif %}

